<app-loading *ngIf="isLoading"></app-loading>
<div class="container_file" *ngIf="showFileModal">
  <div class="block_file">
    <i class="fas fa-times" (click)="closeFileModal()"></i>
    <!--  " -->
    <div class="editFile_block" *ngFor="let fle of dowFile; let idx = index">
      <h1 (click)="download(fle.file)">Файл {{idx + 1}}</h1>
      <i class="fas fas fa-trash" (click)="deleteFiles(fle.file_id)"></i>
    </div>
  </div>
</div>
<app-header></app-header>
<div class="modal-datas_container" *ngIf="creatModalShow">
  
  <div class="modal-datas_block">   
    <div class="close">
      <i class="fa fa-times" (click)="creatModalShow = false"></i>
    </div>
    <div class="cont__form"> 
        <form [formGroup]="addOrderForm">
          <h3>Добавить лот:</h3>
          <div class="form__block">
            <div class="inp__block">
              <div class="inp">
                <h1>Номер Лота:</h1>
                <input type="number" placeholder="Номер лота" formControlName="lot_number">
              </div>
              <div class="inp lots-name">
                <h1>Название лота</h1>
                <input type="text" placeholder="Название лота" formControlName="title">
              </div> 
            </div>
            <h2>Сумма без учета НДС</h2>
            <div class="inp__block currency">
              <div class="inp">
                <h1>Сомони</h1>
                <input type="number" placeholder="Описание" formControlName="total">
              </div>
              <div class="inp">
                <h1>Доллар</h1>
                <input type="number" placeholder="Описание" formControlName="total_dol">
              </div>
              <div class="inp">
                <h1>Евро</h1>
                <input type="number" placeholder="Описание" formControlName="total_euro">
              </div>
            </div>
            <h2>Сумма c учетом НДС</h2>
            <div class="inp__block currency">
              <div class="inp">
                <h1>Сомони</h1>
                <input type="number" placeholder="Описание" formControlName="vat">
              </div>
              <div class="inp">
                <h1>Доллар</h1>
                <input type="number" placeholder="Описание" formControlName="vat_dol">
              </div>
              <div class="inp">
                <h1>Евро</h1>
                <input type="number" placeholder="Описание" formControlName="vat_euro">
              </div>
            </div>
            <h2>Сумма с учетом скидки</h2>
            <div class="inp__block currency">
              <div class="inp">
                <h1>Сомони</h1>
                <input type="number" placeholder="Описание" formControlName="discount">
              </div>
              <div class="inp">
                <h1>Доллар</h1>
                <input type="number" placeholder="Описание" formControlName="discount_dol">
              </div>
              <div class="inp">
                <h1>Евро</h1>
                <input type="number" placeholder="Описание" formControlName="discount_euro">
              </div>
            </div>
          </div>
          <h2>Партнеры:</h2>
          <div class="partners__block">
            <div class="user-part__block">
              <div class="userP" *ngFor="let addPartners of partnersLocalData; let idx = index">
                <p [ngStyle]="{color: addPartners.is_lead ? '#000' : '#757575'}">{{ addPartners.name }}</p>
                <div class="trash" (click)="deleteAddLocalPartners(idx)">
                  <i class="fa fa-trash"></i>
                </div>
              </div>
              <div class="userP"></div>
            </div>
            <div class="lider__block">
              <div class="inp">
                <h1>Партнер</h1>
                <input type="text" placeholder="Партнер" formControlName="partners">
              </div>
              <div class="inp check">
                <input type="text" placeholder="Лидер" readonly>
                <input type="checkbox" class="checkbox" formControlName="is_lead">
              </div>
              <button style="border: none; cursor: pointer;" (click)="addLocalPartners()">
                <i class="fa fa-plus"></i>
              </button>
            </div>
            <div class="btn"(click)="addLot()">
              <button>СОХРАНИТЬ ЛОТ</button>
            </div>
          </div>
        </form>
    </div>
    
  </div>

</div>

<!-- Edit Modal -->
<div class="modal-datas_container" *ngIf="editModalShow">
  
  <div class="modal-datas_block">   
    <div class="close">
      <i class="fa fa-times" (click)="editModalShow = false"></i>
    </div>
    <div class="cont__form"> 
        <form [formGroup]="editOrderForm">
          <h3>Изменить лот:</h3>
          <div class="form__block">
            
            <div class="inp__block">
              <div class="inp">
                <h1>Номер Лота:</h1>
                <input type="number" placeholder="Описание" formControlName="lot_number">
              </div>
              <div class="inp lots-name">
                <h1>Название лота</h1>
                <input type="text" placeholder="Описание" formControlName="title">
              </div>
            </div>
            <h2>Сумма без учета НДС</h2>
            <div class="inp__block currency">
              <div class="inp">
                <h1>Сомони</h1>
                <input type="number" placeholder="Описание" formControlName="total">
              </div>
              <div class="inp">
                <h1>Доллар</h1>
                <input type="number" placeholder="Описание" formControlName="total_dol">
              </div>
              <div class="inp">
                <h1>Евро</h1>
                <input type="number" placeholder="Описание" formControlName="total_euro">
              </div>
            </div>
            <h2>Сумма c учетом НДС</h2>
            <div class="inp__block currency">
              <div class="inp">
                <h1>Сомони</h1>
                <input type="number" placeholder="Описание" formControlName="vat">
              </div>
              <div class="inp">
                <h1>Доллар</h1>
                <input type="number" placeholder="Описание" formControlName="vat_dol">
              </div>
              <div class="inp">
                <h1>Евро</h1>
                <input type="number" placeholder="Описание" formControlName="vat_euro">
              </div>
            </div>
            <h2>Сумма с учетом скидки</h2>
            <div class="inp__block currency">
              <div class="inp">
                <h1>Сомони</h1>
                <input type="number" placeholder="Описание" formControlName="discount">
              </div>
              <div class="inp">
                <h1>Доллар</h1>
                <input type="number" placeholder="Описание" formControlName="discount_dol">
              </div>
              <div class="inp">
                <h1>Евро</h1>
                <input type="number" placeholder="Описание" formControlName="discount_euro">
              </div>
            </div>
          </div>
          <h2>Партнеры:</h2>
          <div class="partners__block">
            <div class="user-part__block">
              <div class="userP" *ngFor="let editPartners of editOrderData.partners; let idx = index">
                <p [ngStyle]="{color: editPartners.is_lead ? '#000' : '#757575'}">{{ editPartners.name }}</p>
                <div class="trash" (click)="deleteEditLocalPartners(idx)">
                  <i class="fa fa-trash"></i>
                </div>
              </div>
            </div>
            <div class="lider__block">
              <div class="inp">
                <h1>Партнер</h1>
                <input type="text" placeholder="Партнер" formControlName="partners">
              </div>
              <div class="inp check">
                <input type="text" placeholder="Лидер" readonly>
                <input type="checkbox" class="checkbox" formControlName="is_lead">
              </div>
              <button style="border: none; cursor: pointer;" (click)="editLocalPartners()">
                <i class="fa fa-plus"></i>
              </button>
            </div>
            <div class="btn" (click)="editLots()">
              <button>ИЗМЕНИТЬ ЛОТ</button>
            </div>
          </div>
        </form>
    </div>
    
  </div>

</div>


<div class="container">
  <div class="content">
    <div class="appbar">
      <h1></h1>
      <h1>Лоты:</h1>
      <h1>
        <div class="plus">
          <div class="plus__block" (click)="creatModalShow = true">
            <i class="fa fa-plus"></i>
          </div>
        </div>
      </h1>
    </div>
    <table class="resp-tab">
      <thead>
        <tr>
          <th rowspan="2">Название лота</th>
          <th rowspan="2">Номер лота</th>
          <th colspan="3">Сумма без учета НДС</th>
          <th colspan="3">Сумма без учета НДС</th>
          <th colspan="3">Сумма с учетом скидки</th>
          <!-- <th colspan="3">Сумма с учетом скидки</th> -->
          <th  rowspan="2" style="color: #112A4A; font-weight: bold;" >Партнеры</th> 
        </tr>
        <tr>  
          <th>Сомони</th>
          <th>Доллар</th>
          <th>Евро</th>
          <th>Сомони</th>
          <th>Доллар</th>
          <th>Евро</th>
          <th>Сомони</th>
          <th>Доллар</th>
          <th>Евро</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let orderLots of orderData[0]?.lots; let idx = index">
          <td><span>Название лота </span>{{ orderLots.title }}</td>  
          <td><span>Номер лота </span>{{ orderLots.lot_number }}</td>
          <td><span>Сумма без учета НДС </span><div class="currancy">
            <i>Сомони : <p>{{ orderLots.total }}</p></i>
            <i>Доллар : <p>{{ orderLots.total_dol }}</p></i>
            <i>Евро : <p>{{ orderLots.total_euro }}</p></i>
          </div> <pre>{{ orderLots.total }}</pre></td>      
          <td class="hdd">{{ orderLots.total_dol }}</td> 
          <td class="hdd">{{ orderLots.total_euro }}</td>
          <td><span>Сумма с учетом НДС</span><div class="currancy">
            <i>Сомони : <p>{{ orderLots.vat }}</p></i>
            <i>Доллар : <p>{{ orderLots.vat_dol }}</p></i>
            <i>Евро : <p>{{ orderLots.vat_euro }}</p></i>
          </div><pre>{{ orderLots.vat }}</pre> </td>
          <td class="hdd">{{ orderLots.vat_dol }}</td>      
          <td class="hdd">{{ orderLots.vat_euro }}</td>
          <td><span>Сумма с учетом скидки</span><div class="currancy">
            <i>Сомони : <p>{{ orderLots.discount }}</p></i>
            <i>Доллар : <p>{{ orderLots.discount_dol }}</p></i>
            <i>Евро : <p>{{ orderLots.discount_euro }}</p></i>
          </div><pre>{{ orderLots.discount }}</pre> </td>
          <td class="hdd">{{ orderLots.discount_dol }}</td>      
          <td class="hdd">{{ orderLots.discount_euro }}</td>  
          <td><span>Партнеры </span> <h1 style="font-size: 13px;" *ngFor="let orderPartners of orderLots.partners" [ngStyle]="{color: orderPartners.is_lead ? '#000' : '#757575'}">{{ orderPartners.name }}</h1> </td>  
          <td class="change"> 
            <div class="trash__block" (click)="openEditModal(idx)">
              <i class="fas fa-pencil-alt"></i>
            </div>
            <div class="trash__block" (click)="deleteLots(idx)"> 
            <i class="fas fa-trash"></i>
            </div>
          </td>  
        </tr> 
      </tbody>
    </table>
  </div>
  <div class="summa">
    <form class="summa__nds" [formGroup]="globalOrderForm">
      <div class="inp-block">
        <h2>Сумма без учета НДС</h2>
        <div class="space-inp">
          <div class="inp">
            <h3>Сомони</h3>
            <input type="number" placeholder="Описание" formControlName="total">
          </div>
          <div class="inp">
            <h3>Доллар</h3>
            <input type="number" placeholder="Описание" formControlName="total_dol">
          </div>
          <div class="inp">
            <h3>Евро</h3>
            <input type="number" placeholder="Описание" formControlName="total_euro">
          </div>
        </div>
      </div>
      <div class="inp-block">
        <h2>Сумма с учетом НДС</h2>
        <div class="space-inp">
          <div class="inp">
            <h3>Сомони</h3>
            <input type="number" placeholder="Описание" formControlName="vat">
          </div>
          <div class="inp">
            <h3>Доллар</h3>
            <input type="number" placeholder="Описание" formControlName="vat_dol">
          </div>
          <div class="inp">
            <h3>Евро</h3>
            <input type="number" placeholder="Описание" formControlName="vat_euro">
          </div>
        </div>
      </div>
      <div class="inp-block">
        <h2>Сумма с учетом скидки</h2>
        <div class="space-inp">
          <div class="inp">
            <h3>Сомони</h3>
            <input type="number" placeholder="Описание" formControlName="discount">
          </div>
          <div class="inp">
            <h3>Доллар</h3>
            <input type="number" placeholder="Описание" formControlName="discount_dol">
          </div>
          <div class="inp">
            <h3>Евро</h3>
            <input type="number" placeholder="Описание" formControlName="discount_euro">
          </div>
        </div>
      </div>
    </form>
    <div class="items_block regist_block">
      <label for="file">Файл</label>
      <div class="file_block">
        <h1>{{ fileName }}</h1>
        <input type="file" multiple accept=".pdf" (change)="newFiles($event)">
        <img src="assets/img/file.svg" alt="">
      </div>
    </div>
    <div class="filesData_block">
      <button (click)="openFileModal(orderData[0].order_files)">Файлы</button>
    </div>
      <button (click)="sendData()">Отправить</button>
  </div>  
</div>
